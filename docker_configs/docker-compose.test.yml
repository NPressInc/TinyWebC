services:
  node_01:
    build:
      context: ! '..'
      dockerfile: ! 'scripts/Dockerfile.node'
    environment:
      TINYWEB_NODE_ID: ! '1'
      TINYWEB_DISCOVERY_MODE: ! 'static'
    volumes:
    - ./node_01/state:/app/state
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - ! 'http://localhost:8000/health'
      interval: ! '30s'
      timeout: ! '10s'
      retries: ! '3'
      start_period: ! '40s'
    restart: ! 'no'
    ports:
    - ! '9000:9000/udp'
    - ! '8001:8000'
  node_02:
    build:
      context: ! '..'
      dockerfile: ! 'scripts/Dockerfile.node'
    environment:
      TINYWEB_NODE_ID: ! '2'
      TINYWEB_DISCOVERY_MODE: ! 'static'
    volumes:
    - ./node_02/state:/app/state
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - ! 'http://localhost:8000/health'
      interval: ! '30s'
      timeout: ! '10s'
      retries: ! '3'
      start_period: ! '40s'
    restart: ! 'no'
    ports:
    - ! '9001:9000/udp'
    - ! '8002:8000'
  node_03:
    build:
      context: ! '..'
      dockerfile: ! 'scripts/Dockerfile.node'
    environment:
      TINYWEB_NODE_ID: ! '3'
      TINYWEB_DISCOVERY_MODE: ! 'static'
    volumes:
    - ./node_03/state:/app/state
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - ! 'http://localhost:8000/health'
      interval: ! '30s'
      timeout: ! '10s'
      retries: ! '3'
      start_period: ! '40s'
    restart: ! 'no'
    ports:
    - ! '9002:9000/udp'
    - ! '8003:8000'
  node_04:
    build:
      context: ! '..'
      dockerfile: ! 'scripts/Dockerfile.node'
    environment:
      TINYWEB_NODE_ID: ! '4'
      TINYWEB_DISCOVERY_MODE: ! 'static'
    volumes:
    - ./node_04/state:/app/state
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - ! 'http://localhost:8000/health'
      interval: ! '30s'
      timeout: ! '10s'
      retries: ! '3'
      start_period: ! '40s'
    restart: ! 'no'
    ports:
    - ! '9003:9000/udp'
    - ! '8004:8000'
